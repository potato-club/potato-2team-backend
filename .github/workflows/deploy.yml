name: Deploying Application Server
on:
  push:
    branches:
      - develop
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: checkout@v2
        uses: actions/checkout@v2

      - name: Packaging JAR file with Gradle Wrapper ğŸ¦¦
        run: ./gradlew clean build

      - name: Change JAR Packaging Name ğŸ‡
        run: mv ./build/libs/*.jar ./build/libs/app.jar

      - name: Upload JAR file ğŸ¦¦
        uses: actions/upload-artifact@v2
        with:
          name: app.jar
          path: ./build/libs/app.jar
  deploy:
    needs:
      - build
    runs-on: potato-2team
    steps:
      - name: Download app.jar ğŸ‡
        uses: actions/download-artifact@v2
        with:
          name: app.jar

      - name: Run sever with JAR file ğŸ¦¦
        run: |
          mv app.jar ~/app.jar
          RUNNER_TRACKING_ID="" && sh ~/scripts/deploy.sh &
